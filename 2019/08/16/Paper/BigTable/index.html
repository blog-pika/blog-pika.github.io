<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">

  <!-- PACE Progress Bar START -->
  
    <script src="https://raw.githubusercontent.com/HubSpot/pace/v1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://github.com/HubSpot/pace/raw/master/themes/orange/pace-theme-flash.css">
  
  

  <!-- PACE Progress Bar START -->

  
  <title>bigtable | The Code and Sixpence</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta name="description" content="This blog is my reading notes for Google Bigtable. Pros and ConsAPIClient applications can write or delete values in Bigtable, look up values from individual rows, or iterate over a subset of the data">
<meta property="og:type" content="article">
<meta property="og:title" content="BigTable">
<meta property="og:url" content="https://blog-pika.github.io/2019/08/16/Paper/BigTable/index.html">
<meta property="og:site_name" content="The Code and Sixpence">
<meta property="og:description" content="This blog is my reading notes for Google Bigtable. Pros and ConsAPIClient applications can write or delete values in Bigtable, look up values from individual rows, or iterate over a subset of the data">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://blog-pika.github.io/images/Bigtable/Bigtable-Data-Model.png">
<meta property="og:image" content="https://blog-pika.github.io/images/Bigtable/Bigtable-System-Structure.png">
<meta property="og:image" content="https://blog-pika.github.io/images/Bigtable/BigTable-Tablet-Representation.png">
<meta property="og:image" content="https://blog-pika.github.io/images/Bigtable/Bigtable-Tablet-location-hierarchy.png">
<meta property="og:updated_time" content="2019-08-20T03:16:06.082Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BigTable">
<meta name="twitter:description" content="This blog is my reading notes for Google Bigtable. Pros and ConsAPIClient applications can write or delete values in Bigtable, look up values from individual rows, or iterate over a subset of the data">
<meta name="twitter:image" content="https://blog-pika.github.io/images/Bigtable/Bigtable-Data-Model.png">
  
    <link rel="alternate" href="/atom.xml" title="The Code and Sixpence" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="https://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/hiero.css">
  <link rel="stylesheet" href="/css/glyphs.css">
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/my.css">
  <!-- Google Adsense -->
  
</head>
</html>
<script>
var themeMenus = {};

  themeMenus["/"] = "Home"; 

  themeMenus["/archives"] = "Archives"; 

  themeMenus["/categories"] = "Categories"; 

  themeMenus["/tags"] = "Tags"; 

  themeMenus["/about"] = "About"; 

</script>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="The Code and Sixpence" rel="home"> The Code and Sixpence </a>
            
          </h1>

          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">Categories</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">Tags</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">About</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>


  <div id="originBgDiv" style="background: #fff; width: 100%;">

      <div style="max-height:600px; overflow: hidden;  display: flex; display: -webkit-flex; align-items: center;">
        <img id="originBg" width="100%" alt="" src="">
      </div>

  </div>

  <script>
  function setAboutIMG(){
      var imgUrls = "css/images/pose.jpg,https://source.unsplash.com/collection/954550/1920x1080".split(",");
      var random = Math.floor((Math.random() * imgUrls.length ));
      if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
        document.getElementById("originBg").src=imgUrls[random];
      } else {
        document.getElementById("originBg").src='/' + imgUrls[random];
      }
  }
  bgDiv=document.getElementById("originBgDiv");
  if(location.pathname.match('about')){
    setAboutIMG();
    bgDiv.style.display='block';
  }else{
    bgDiv.style.display='none';
  }
  </script>



  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-Paper/BigTable" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      BigTable
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/2019/08/16/Paper/BigTable/" class="article-date">
	  <time datetime="2019-08-16T16:46:00.000Z" itemprop="datePublished">August 16, 2019</time>
	</a>

      
	<span id="busuanzi_container_page_pv">
	  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
	</span>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>This blog is my reading notes for Google Bigtable.</p>
<h2 id="Pros-and-Cons"><a href="#Pros-and-Cons" class="headerlink" title="Pros and Cons"></a>Pros and Cons</h2><h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><p>Client applications can write or delete values in Bigtable, look up values from individual rows, or iterate over a subset of the data in a table. Bigtable supports <strong>single-row transaction</strong>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Writing to Bigtable</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Open the table</span></span><br><span class="line">Table *T = OpenOrDie(<span class="string">"/bigtable/web/webtable"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Write a new anchor and delete an old anchor</span></span><br><span class="line"><span class="function">RowMutation <span class="title">r1</span><span class="params">(T, <span class="string">"com.cnn.www"</span>)</span></span>;</span><br><span class="line">r1.Set(<span class="string">"anchor:www.c-span.org"</span>, <span class="string">"CNN"</span>);</span><br><span class="line">r1.Delete(<span class="string">"anchor:www.abc.com"</span>);</span><br><span class="line">Operation op; Appaly(&amp;op, &amp;r1);</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Reading from Bigtable</span></span><br><span class="line"><span class="function">Scanner <span class="title">scanner</span><span class="params">(T)</span></span>;</span><br><span class="line">ScanStream *stream;</span><br><span class="line">stream = scanner.FetchColumnFamily(<span class="string">"anchor"</span>);</span><br><span class="line">stream-&gt;SetReturnAllVersions();</span><br><span class="line">scanner.Lookup(<span class="string">"com.cnn.www"</span>);</span><br><span class="line"><span class="keyword">for</span> (; !stream-&gt;Done(); stream-&gt;Next()) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s %s %lld %s\n"</span>, scanner.RowName(),</span><br><span class="line">      stream-&gt;ColumnName(),</span><br><span class="line">      stream-&gt;MicroTimestamp(),</span><br><span class="line">      stream-&gt;Value());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Data-Model"><a href="#Data-Model" class="headerlink" title="Data Model"></a>Data Model</h2><p>Bigtable is a sparse, distributed, persistent multidimensional sorted map. The map is indexed by a <code>row key</code>, <code>column key</code>, and a <code>timestamp</code>, each value in the map is an uninterpreted array of bytes.</p>
<p>Every read or write of data under a single row key is <strong>atomic</strong>. The row range for a table is dynamically partitioned, which is called <code>tablet</code> and is the <strong>unit of distribution and load balancing</strong>.</p>
<p>Column keys are grouped into sets called column families, which form the basic <strong>unit of access control</strong>. All data stored in a column family is usually of the same type, which can be indexed with: <code>family:qualifier</code>.</p>
<p>Each cell in a Bigtable can contain multiple versions of the same data; these versions are indexed by timestamp. The client can specify either that only the last n versions of a cell be kept, or that only new-enough versions be kept. The out-dated versions are GC automatically.</p>
<p><img src="/images/Bigtable/Bigtable-Data-Model.png" alt="Bigtable-Data-Model"></p>
<h2 id="Architecture"><a href="#Architecture" class="headerlink" title="Architecture"></a>Architecture</h2><p>Under the hook, Bigtable uses several other Google infrastructure as below</p>
<ul>
<li><code>GFS</code>: store logs and data files</li>
<li><code>Borg</code>: schedule jobs, manage resources, deal with machine failures and monitoring machine status</li>
<li><code>Chubby</code>: avoid multiple master, store the bootstrap location, discover tablet servers and finalize tablet server deaths</li>
</ul>
<p><img src="/images/Bigtable/Bigtable-System-Structure.png" alt="Bigtable System Structure"></p>
<p>For the components in BigTable:</p>
<ul>
<li><code>Master</code>: responsible for assigning tablets to tablet servers, detecting the addition and expiration of tablet servers, balancing tablet-server load, and garbage collection of files in GFS</li>
<li><code>tablet server</code>: manages a set of tablets</li>
<li><code>clients</code>: every client has a client library, which caches tablet locations, so a client can communicate directly with tablet servers for reads and writes</li>
</ul>
<p><img src="/images/Bigtable/BigTable-Tablet-Representation.png" alt="BigTable Tablet Representation"></p>
<p>When a write operation arrives at a tablet server, the server checks that it is well-formed, and that the sender is authorized to perform the mutation. A valid mutation is written to the commit log. After the write has been committed, its contents are inserted into the memtable. When a read operation arrives at a tablet server, it is executed on a merged view of the sequence of SSTables and the memtable.</p>
<h2 id="Data-Storage-Engine"><a href="#Data-Storage-Engine" class="headerlink" title="Data Storage Engine"></a>Data Storage Engine</h2><p>BigTable used the data structure of <code>SSTable</code>, <code>memtable</code> and <code>Bloomfilter</code>. Also, it uses column storage and compression for the column. For detail you can refer to <em>Designing Data-Intensive Applications</em>, Chapter 03: Storage and Retrieval.</p>
<h3 id="Service-Discovery"><a href="#Service-Discovery" class="headerlink" title="Service Discovery"></a>Service Discovery</h3><p>Chubby is the key to discover all the servers and tablet information in BigTable. When a tablet server/master server starts, it creates, and acquires an exclusive lock on Chubby directory. Therefore, a server can find the information and status of other servers by asking Chubby.</p>
<p>Chubby if also the root for a three-level hierarchy to store tablet location information.</p>
<ul>
<li>first level: Chubby that contains the location of the root tablet</li>
<li>second level: Root tablet contains the location of all tablets in a special METADATA table</li>
<li>third level: each METADATA tablet contains the location of a set of user tablets</li>
</ul>
<p><img src="/images/Bigtable/Bigtable-Tablet-location-hierarchy.png" alt="Bigtable Tablet Location Hierarchy"></p>
<h3 id="Load-Balance"><a href="#Load-Balance" class="headerlink" title="Load Balance"></a>Load Balance</h3><p>Most Load balancing are done by the master except one:</p>
<ul>
<li>Master: a table is created or deleted, two existing tablets are merged to form one larger tablet</li>
<li>Tablet Server: an existing tablet is split into two smaller tablets</li>
</ul>
<p>The master is able to keep track of these changes because it initiates all. Tablet splits are treated specially since they are initiated by a tablet server. The tablet server commits the split by recording information for the new tablet in the METADATA table. When the split has committed, it notifies the master. In case the split notification is lost (either because the tablet server or the master died), the master detects the new tablet when it asks a tablet server to load the tablet that has now split. The tablet server will notify the master of the split, because the tablet entry it finds in the METADATA table will specify only a portion of the tablet that the master asked it to load.</p>
<h3 id="Fault-Tolerance"><a href="#Fault-Tolerance" class="headerlink" title="Fault Tolerance"></a>Fault Tolerance</h3><p>GFS and Chubby are fault-tolerant, which can simplify the design of BitTable. <strong>GFS takes care of the fault-tolerance of file and Bigtable uses Chubby to keep track of servers</strong>. If Chubby fails, BigTable will soon be unavailable. For the master, it kills itself if its Chubby session expires. Since master only cares about load balancing and meta data, the crash of master is not a big deal, Borg can simply start a new master:</p>
<ol>
<li>he master grabs a unique master lock in Chubby, which prevents concurrent master instantiations</li>
<li>The master scans the servers directory in Chubby to find the live servers.</li>
<li>The master communicates with every live tablet server to discover what tablets are already assigned to each server.</li>
<li>The master scans the METADATA table to learn the set of tablets.</li>
</ol>
<p>What if the tablet server is unavailable? The master is responsible for detecting when a tablet server is no longer serving its tablets. If a tablet server is unavailable, it loses its exclusive lock. T<strong>he master periodically asks each tablet server for the status of its lock</strong>. If a tablet server reports that it has lost its lock, or if the master was unable to reach a server during its last several attempts, the master attempts to acquire an exclusive lock on the server’s file. If the master is able to acquire the lock, then Chubby is live and the tablet server is either dead or having trouble reaching Chubby, so the master ensures that the tablet server can never serve again by deleting its server file. Once a server’s file has been deleted, the master can move all the tablets that were previously assigned to that server into the set of unassigned tablets.</p>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><blockquote>
<p>Q: When a server crashes, will the data in memetable lost?</p>
</blockquote>
<p>A: No, the write operation writes the logs in GFS first, so the memory data can be recovered from logs.</p>
<blockquote>
<p>Q: Will Chubby file or Root Tablet be the hotspot?</p>
</blockquote>
<p>A: No. Client library does aggressive pre-fetching and caching so the root tablet file is not accessed that frequently.</p>
<blockquote>
<p>Q: How does this work: <strong>The only mutable data structure that is accessed by both reads and writes is the memtable. To reduce contention during reads of the memtable, we make each memtable row copy-on-write and allow reads and writes to proceed in parallel.</strong></p>
</blockquote>
<p>A: ???</p>
<blockquote>
<p>Q: How can two log writing threads protects mutations from GFS latency spikes?</p>
</blockquote>
<p>A: ???</p>
<blockquote>
<p>Q: How can copy-on-write on each memtable row allows reads and writes to proceed in parallel?</p>
</blockquote>
<p>A:???</p>
<blockquote>
<p>GFS可能出现重复记录或者padding，Bigtable如何处理这种情况使得对外提供强一致性模型？</p>
</blockquote>
<blockquote>
<p>为什么Bigtable设计成Root、Meta、User三级结构，而不是两级或者四级结构？</p>
</blockquote>
<blockquote>
<p>读取某一行用户数据，最多需要几次请求？分别是什么？</p>
</blockquote>
<blockquote>
<p>如何保证同一个tablet不会被多台机器同时服务？</p>
</blockquote>
<blockquote>
<p>Tablet在内存中的数据结构如何设计？</p>
</blockquote>
<blockquote>
<p>如何设计SSTable的存储格式？</p>
<p>minor、merging、major这三种compaction有什么区别？</p>
<p>Tablet Server的缓存如何实现？</p>
<p>如果tablet出现故障，需要将服务迁移到其它机器，这个过程需要排序操作日志。如何实现？</p>
<p>如何使得tablet迁移过程停服务时间尽量短？</p>
<p>tablet分裂的流程是怎样的？</p>
<p>tablet合并的流程是怎样的？</p>
</blockquote>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol>
<li><a href="https://static.googleusercontent.com/media/research.google.com/en//archive/bigtable-osdi06.pdf" target="_blank" rel="noopener">Bigtable: A Distributed Storage System for Structured Data</a></li>
<li><a href="https://www.youtube.com/watch?v=2cXBNQClehA" target="_blank" rel="noopener">Youtube: BigTable: A Distributed Structured Storage System</a>  </li>
<li><a href="https://www.zhihu.com/question/37647788/answer/72960959" target="_blank" rel="noopener">有哪些分布式数据库书籍或论文比较好？</a>  </li>
<li>Designing Data-Intensive Applications, Chapter 03: Storage and Retrieval</li>
</ol>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/Paper/">Paper</a>

      
      
            
      
        
	<section id="comments" class="comment">
	  <div id="disqus_thread">
	  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	  </div>
	</section>

	<script type="text/javascript">
	var disqus_shortname = 'disqus_t7ZVi0Vi0o';
	(function(){
	  var dsq = document.createElement('script');
	  dsq.type = 'text/javascript';
	  dsq.async = true;
	  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	}());
	(function(){
	  var dsq = document.createElement('script');
	  dsq.type = 'text/javascript';
	  dsq.async = true;
	  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
	  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	}());
	</script>


      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/08/19/Distributed-System-101/Consistency-Level/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Consistency Level
        
      </div>
    </a>
  
  
    <a href="/2019/08/15/Data-Structures-That-Power-Your-Database/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Data Structures That Power Your Database</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article" style="overflow-y: scroll; max-width: 28%;">
    <strong class="toc-title">Contents</strong>
    
      <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Pros-and-Cons"><span class="nav-number">1.</span> <span class="nav-text">Pros and Cons</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#API"><span class="nav-number">2.</span> <span class="nav-text">API</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Data-Model"><span class="nav-number">3.</span> <span class="nav-text">Data Model</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Architecture"><span class="nav-number">4.</span> <span class="nav-text">Architecture</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Data-Storage-Engine"><span class="nav-number">5.</span> <span class="nav-text">Data Storage Engine</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Service-Discovery"><span class="nav-number">5.1.</span> <span class="nav-text">Service Discovery</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Load-Balance"><span class="nav-number">5.2.</span> <span class="nav-text">Load Balance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fault-Tolerance"><span class="nav-number">5.3.</span> <span class="nav-text">Fault Tolerance</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FAQ"><span class="nav-number">6.</span> <span class="nav-text">FAQ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">7.</span> <span class="nav-text">Reference</span></a></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2019 The Code and Sixpence All Rights Reserved.
          
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hiero" target="_blank">hiero</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>

<!-- Custome JS -->
<script src="/js/my.js"></script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>


<script src="/js/scripts.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'true', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->







	<script async src="https://dnqof95d40fo6.cloudfront.net/atw7f8.js">
	</script>





<!-- Tencent Analytics -->
	<script type="text/javascript">
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId={{ theme.tencent_analytics }}";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>
<!-- End Tencent Analytics -->


  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
